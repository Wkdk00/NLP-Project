# NLP-Project

Проект для автоматического анализа телефонных разговоров с выделением речи спикеров, транскрибацией и оценкой вежливости продавца с помощью AI.

## Возможности

- Диаризация - автоматическое разделение речи на спикеров
- Транскрибация - преобразование речи в текст с временными метками
- Анализ вежливости - оценка поведения продавца по шкале от 1 до 10

##  Установка и настройка

### Требования
- Python 3.8+
- FFmpeg (для обработки аудио)
- API токены для сервисов

### Получение API токенов

1. **Hugging Face Token**:
   - Зарегистрируйтесь на [huggingface.co](https://huggingface.co)
   - Получите токен в настройках профиля
   - Примите условия использования модели [pyannote/speaker-diarization-3.1](https://huggingface.co/pyannote/speaker-diarization-3.1)

2. **DeepSeek Token**:
   - Зарегистрируйтесь на [intelligence.io.solutions](https://api.intelligence.io.solutions)
   - Получите API токен для доступа к DeepSeek R1

## Использование

### Базовая команда

```bash
python main.py
```

##  Формат вывода

Результаты сохраняются в `output/raw_transcript.txt`:

```
[0.0-2.5] SPEAKER_01: Добрый день, меня зовут Иван
[2.5-5.0] SPEAKER_00: Здравствуйте, я по поводу заказа
...
```

##  Решение проблем

1. **Ошибка загрузки моделей**:
   - Проверьте интернет-соединение
   - Убедитесь в правильности токенов

2. **Проблемы с аудио**:
   - Убедитесь, что файл в формате WAV
   - Проверьте наличие FFmpeg

3. **Память GPU**:
   - При нехватке памяти используйте меньшие модели Whisper

### Поддерживаемые форматы аудио

- WAV (рекомендуется)
- MP3 (конвертируется автоматически)
- FLAC
- OGG

## Пример результата

После обработки система выдает оценку вежливости продавца:

```
10
```
---

*Для качественных результатов используйте аудио с хорошим качеством записи и минимальным количеством фоновых шумов.*





